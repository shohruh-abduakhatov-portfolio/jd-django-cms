function StationSearch(e){let t=null;const a=document.getElementById("input-"+e),n=document.getElementById("loader-"+e),o=document.getElementById("result-"+e);let i=null;function s(e){n.style.display=e?"block":"none"}function r(){const n=a.value;n.length>2?(s(!0),clearTimeout(i),i=setTimeout(function(){t=$.ajax({url:"http://178.218.200.63:8080/api/v1/station/list",type:"post",dataType:"json",contentType:"application/json",data:JSON.stringify({nameFull:n}),success:function(n){s(!1),console.log(n),o.innerHTML="",n.station.length&&n.station.forEach(function(t){const n=document.createElement("li");n.innerText=t.nameFull,n.className="list-group-item list-group-item-action",n.onclick=function(){a.value=t.nameFull,sessionStorage.setItem(e,t.code),o.innerHTML=""},o.appendChild(n)}),t=null}})},500)):(s(!1),null!==t&&t.abort())}s(!1),this.search=function(){r()},this.setSearchValue=function(e){a.value=e,r()}}const from=new StationSearch("from"),to=new StationSearch("to");let sdVal1="КОГДА",sdVal2="",onlyForward=!0;const datepickerInput=$("#datepicker-input"),datepickerWrapper=$(".datepicker"),datepicker=$("#datepicker"),datepickerMulti=$("#datepicker-multi"),buttons=$(".btn-outline-accent"),date=new Date,today=date.getMonth()+1,newDate=new Date(date.setDate(date.getDate()+40));let after=newDate.getMonth()+1;after<today&&(after+=12);const numberOfMonths=after-today+1;function eventInput(){event.stopPropagation(),datepickerWrapper.is(":hidden")?datepickerWrapper.show():datepickerWrapper.hide()}function forward(e){event.stopPropagation(),onlyForward=!0,buttons.removeClass("active"),e.classList?e.classList.add("active"):e.className+=" active",datepickerMulti.hide(),datepicker.show()}function backward(e){event.stopPropagation(),onlyForward=!1,buttons.removeClass("active"),e.classList?e.classList.add("active"):e.className+=" active",datepickerMulti.show(),datepicker.hide()}function exchange(){const e=$("input-from"),t=$("input-to"),a=e.val();e.val(t.val()),t.val(a)}function gotoNext(){const e=+sessionStorage.getItem("from")||0,t=+sessionStorage.getItem("to")||0,a=sessionStorage.getItem("value")||"",n=sessionStorage.getItem("value2")||"";if(0!==e&&0!==t){const o="http://178.218.200.63:80/";let i="",s=sessionStorage.getItem("token");if(s||(s=getCookie("token")),s&&(console.log("token"),i="&token="+s),!0===onlyForward){if(a.length){const n=a.split("/"),s=n[1]+"."+n[0]+"."+n[2];console.log(o+"process/train/?f="+e+"&t="+t+"&date="+s+i),window.location.href=o+"process/train/?f="+e+"&t="+t+"&date="+s+i}}else if(a.length&&n.length){const s=a.replace(/\//g,"."),r=n.replace(/\//g,".");window.location.href=o+"process/train/?f="+e+"&t="+t+"&date="+s+"&date2="+r+i}}}datepicker.datepicker({numberOfMonths:numberOfMonths,showButtonPanel:!1,showOtherMonths:!0,minDate:0,maxDate:"+40D",onSelect:function(e){sessionStorage.setItem("value",e),sessionStorage.removeItem("value2");const t=e.split("/");sdVal1=t[1]+"/"+t[0]+"/"+t[2],datepickerInput.val(sdVal1),datepickerWrapper.hide()}}),datepicker.datepicker("option",$.datepicker.regional.ru),datepicker.datepicker("option","showAnim","None"),datepicker.datepicker("option","dateFormat","mm/dd/yy"),datepickerMulti.datepicker({range:"period",numberOfMonths:numberOfMonths,showButtonPanel:!1,showOtherMonths:!0,minDate:0,maxDate:"+40D",onSelect:function(e,t,a){const n=a.startDateText.split("/");sdVal1=n[1]+"/"+n[0]+"/"+n[2];const o=a.endDateText.split("/");sdVal2=o[1]+"/"+o[0]+"/"+o[2],sessionStorage.setItem("value",sdVal1),sessionStorage.setItem("value2",sdVal2),datepickerInput.val(sdVal1+" - "+sdVal2),sdVal1!==sdVal2&&datepickerWrapper.hide()}}),datepickerMulti.datepicker("option",$.datepicker.regional.ru),datepickerMulti.datepicker("option","showAnim","None"),datepickerMulti.datepicker("option","dateFormat","mm/dd/yy"),datepickerMulti.hide(),$(document).on("click",function(){datepickerWrapper.hide()}),datepickerInput.on("click",eventInput);
